<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>ã‚¹ã‚¿ãƒƒãƒ•ç”¨ãƒãƒ³ãƒ‡ã‚£ã‚ªãƒ¼ãƒ€ãƒ¼</title>
<style>
* { margin:0; padding:0; box-sizing:border-box; }
body { font-family: 'Segoe UI', Arial, sans-serif; background:#f5f5f5; }

/* ãƒ˜ãƒƒãƒ€ãƒ¼ */
header { 
    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
    color:white; 
    padding:15px 30px; 
    display:flex; 
    justify-content:space-between; 
    align-items:center;
    box-shadow: 0 2px 10px rgba(0,0,0,0.1);
}
header h1 { font-size:24px; }
.header-actions { display:flex; gap:15px; align-items:center; }
.notification-icon { 
    position:relative; 
    background:rgba(255,255,255,0.2); 
    padding:8px 15px; 
    border-radius:8px; 
    cursor:pointer;
    font-size:18px;
}
.notification-badge { 
    position:absolute; 
    top:-5px; 
    right:-5px; 
    background:#ff4757; 
    color:white; 
    border-radius:50%; 
    padding:2px 8px; 
    font-size:12px;
    display:none;
}
.notification-badge.active { display:block; }
.logout-btn { 
    background:rgba(255,255,255,0.2); 
    color:white; 
    border:none; 
    padding:8px 15px; 
    border-radius:8px; 
    cursor:pointer; 
    text-decoration:none;
}
.logout-btn:hover { background:rgba(255,255,255,0.3); }

/* ãƒ¡ã‚¤ãƒ³ */
.main { display:flex; padding:20px; gap:20px; max-width:1400px; margin:0 auto; }

/* å·¦å´ï¼šãƒ†ãƒ¼ãƒ–ãƒ«ä¸€è¦§ */
.table-list { 
    width:220px; 
    display:grid; 
    grid-template-columns:1fr 1fr;
    gap:12px; 
    height:fit-content;
}
.table-item { 
    padding:20px 10px; 
    border-radius:10px; 
    color:white; 
    text-align:center; 
    cursor:pointer; 
    position:relative;
    font-weight:bold;
    font-size:16px;
    transition: all 0.3s;
    box-shadow: 0 2px 5px rgba(0,0,0,0.1);
}
.table-item:hover { transform:translateY(-3px); box-shadow: 0 4px 10px rgba(0,0,0,0.2); }
.table-item.empty { background:#95a5a6; }
.table-item.occupied { background:#3498db; }
.table-item.pending-payment { background:#f39c12; }
.table-item.active { outline: 3px solid #2ecc71; outline-offset: 2px; }
.table-item.notification::after {
    content: attr(data-badge); 
    position:absolute; 
    right:8px; 
    top:8px; 
    background:#e74c3c; 
    width:24px; 
    height:24px;
    border-radius:50%; 
    display:flex; 
    align-items:center; 
    justify-content:center; 
    font-size:14px;
    font-weight:bold;
    animation: pulse 1.5s infinite;
}
@keyframes pulse {
    0%, 100% { transform:scale(1); opacity:1; }
    50% { transform:scale(1.1); opacity:0.8; }
}

/* å³å´ï¼šæ³¨æ–‡è©³ç´°ãƒ‘ãƒãƒ« */
.side-panel {
    flex-grow:1; 
    background:#fff; 
    border-radius:12px;
    padding:25px; 
    box-shadow: 0 2px 10px rgba(0,0,0,0.1);
}
.side-panel h3 { 
    color:#333; 
    margin-bottom:20px; 
    padding-bottom:10px; 
    border-bottom:2px solid #667eea;
    font-size:22px;
}
.empty-state { text-align:center; color:#999; padding:60px 20px; font-size:16px; }

/* æ³¨æ–‡ã‚¢ã‚¤ãƒ†ãƒ  */
.order-section { margin-bottom:25px; }
.order-section h4 { 
    color:#667eea; 
    margin-bottom:12px; 
    font-size:16px;
    display:flex;
    align-items:center;
    gap:8px;
}
.order-time { color:#999; font-size:13px; font-weight:normal; }
.order-item { display:flex; justify-content:space-between; align-items:center; margin:10px 0; padding:12px; background:#f8f9fa; border-radius:8px; border-left:4px solid #667eea; transition: all 0.3s; }
.order-item:hover { background:#e9ecef; }
.order-item-info { flex-grow:1; }
.order-item-name { font-weight:600; color:#333; font-size:15px; }
.order-item-options { font-size:13px; color:#666; margin-top:3px; }
.status-label { padding:4px 12px; border-radius:12px; font-size:12px; font-weight:bold; margin-right:10px; }
.status-pending { background:#ffebee; color:#c62828; }
.status-delivered { background:#e8f5e9; color:#2e7d32; }
.order-item.delivered { opacity:0.6; border-left-color:#ccc; }
.order-item.delivered .order-item-name { text-decoration:line-through; color:#999; }

/* ãƒœã‚¿ãƒ³ */
.btn { padding:6px 14px; cursor:pointer; border:none; border-radius:6px; font-size:13px; font-weight:600; transition: all 0.3s; }
.btn:hover { opacity:0.85; transform:translateY(-1px); }
.btn:disabled { opacity:0.5; cursor:not-allowed; transform:none; }
.btn-primary { background:#667eea; color:white; }
.btn-success { background:#2ecc71; color:white; }
.btn-warning { background:#f39c12; color:white; }
.btn-danger { background:#e74c3c; color:white; }

/* ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ã‚¨ãƒªã‚¢ */
.action-area { margin-top:25px; padding-top:20px; border-top:2px solid #eee; display:flex; gap:10px; }

/* ãƒ¢ãƒ¼ãƒ€ãƒ« */
.modal { display:none; position:fixed; top:0; left:0; width:100%; height:100%; background:rgba(0,0,0,0.5); z-index:1000; align-items:center; justify-content:center; overflow-y:auto; }
.modal.active { display:flex; }
.modal-content { background:white; border-radius:12px; width:90%; max-width:600px; box-shadow: 0 10px 40px rgba(0,0,0,0.3); }
.modal-header { padding:20px; border-bottom:1px solid #eee; display:flex; justify-content:space-between; align-items:center; }
.modal-header h3 { color:#333; font-size:20px; }
.close-btn { background:none; border:none; font-size:24px; cursor:pointer; color:#999; }
.close-btn:hover { color:#333; }
.modal-body { padding:20px; }
.modal-footer { padding:20px; border-top:1px solid #eee; display:flex; justify-content:flex-end; gap:10px; }

/* ãƒ¡ãƒ‹ãƒ¥ãƒ¼æ¤œç´¢ */
.menu-search { margin-bottom:15px; display:flex; gap:8px; }
.menu-search input { flex-grow:1; padding:6px 10px; border-radius:6px; border:1px solid #ccc; }
.menu-category { font-weight:bold; margin-top:15px; margin-bottom:8px; }
.menu-item { display:flex; justify-content:space-between; padding:10px; border-radius:6px; background:#f1f3f5; margin-bottom:6px; cursor:pointer; }
.menu-item:hover { background:#e9ecef; }
</style>
</head>
<body>

<header>
    <h1>ğŸ“‹ ã‚¹ã‚¿ãƒƒãƒ•ç”¨ãƒãƒ³ãƒ‡ã‚£ã‚ªãƒ¼ãƒ€ãƒ¼</h1>
    <div class="header-actions">
        <div class="notification-icon" onclick="showAllOrdersHistory()">
            ğŸ”” <span id="notificationBadge" class="notification-badge">0</span>
        </div>
        <a href="#" class="logout-btn" onclick="alert('ãƒ­ã‚°ã‚¢ã‚¦ãƒˆæ©Ÿèƒ½ï¼ˆæœªå®Ÿè£…ï¼‰')">ãƒ­ã‚°ã‚¢ã‚¦ãƒˆ</a>
    </div>
</header>

<div class="main">
    <div class="table-list" id="tableList"></div>
    <div class="side-panel" id="sidePanel">
        <h3>ãƒ†ãƒ¼ãƒ–ãƒ«è©³ç´°</h3>
        <div class="empty-state">
            <p>ğŸ‘ˆ å·¦å´ã®ãƒ†ãƒ¼ãƒ–ãƒ«ã‚’é¸æŠã—ã¦ãã ã•ã„</p>
        </div>
    </div>
</div>

<script>
// ========================
// ãƒ€ãƒŸãƒ¼ãƒ‡ãƒ¼ã‚¿
// ========================
const tablesData = Array.from({length:10},(_,i)=>({
    id:i+1, number:i+1, is_occupied: i%2===0, has_pending_payment: i===5
}));

const menuData = [
    {id:101,name:'ãƒã‚­ãƒ³ã‚«ãƒ¬ãƒ¼',category:'ãƒ•ãƒ¼ãƒ‰',price:1200},
    {id:102,name:'ãƒãƒˆãƒ³ã‚«ãƒ¬ãƒ¼',category:'ãƒ•ãƒ¼ãƒ‰',price:1400},
    {id:201,name:'ãƒãƒ³ã‚´ãƒ¼ãƒ©ãƒƒã‚·ãƒ¼',category:'ãƒ‰ãƒªãƒ³ã‚¯',price:500},
    {id:202,name:'ãƒãƒ£ã‚¤',category:'ãƒ‰ãƒªãƒ³ã‚¯',price:300}
];

let ordersData = {
    1:[{id:1,name:'ãƒã‚­ãƒ³ã‚«ãƒ¬ãƒ¼',options:'è¾›ã•:ä¸­è¾›',status:'pending',price:1200}],
    2:[{id:2,name:'ãƒãƒ£ã‚¤',options:null,status:'delivered',price:300}],
    6:[{id:6,name:'ãƒãƒˆãƒ³ã‚«ãƒ¬ãƒ¼',options:'è¾›ã•:æ¿€è¾›',status:'delivered',price:1400}]
};

// ========================
// ã‚°ãƒ­ãƒ¼ãƒãƒ«
// ========================
let currentTableId = null;
let tempOrders = []; // ç¢ºå®šå‰ã®ä¸€æ™‚æ³¨æ–‡

// ========================
// åˆæœŸè¡¨ç¤º
// ========================
document.addEventListener('DOMContentLoaded', ()=>{
    renderTables();
    updateNotificationBadge();
});

// ========================
// ãƒ†ãƒ¼ãƒ–ãƒ«æç”»
// ========================
function renderTables(){
    const container=document.getElementById('tableList');
    container.innerHTML=tablesData.map(t=>{
        let cls='empty';
        if(t.has_pending_payment) cls='pending-payment';
        else if(t.is_occupied) cls='occupied';
        const pendingCount = (ordersData[t.id]||[]).filter(o=>o.status==='pending').length;
        const notifClass = pendingCount>0?'notification':'';
        const badgeAttr = pendingCount>0?`data-badge="${pendingCount}"`:'';
        const activeClass = currentTableId===t.id?'active':'';
        return `<div class="table-item ${cls} ${notifClass} ${activeClass}" ${badgeAttr} data-id="${t.id}" onclick="selectTable(${t.id})">#${t.number}</div>`;
    }).join('');
}

// ========================
// ãƒ†ãƒ¼ãƒ–ãƒ«é¸æŠãƒ»è©³ç´°æç”»
// ========================
function selectTable(id){
    currentTableId=id;
    tempOrders = []; // ä¸€æ™‚æ³¨æ–‡ãƒªã‚»ãƒƒãƒˆ
    renderTables();
    const table = tablesData.find(t=>t.id===id);
    const orders = ordersData[id]||[];
    renderSidePanel(table, orders);
}

function renderSidePanel(table, orders){
    let html=`<h3>ãƒ†ãƒ¼ãƒ–ãƒ« #${table.number}</h3>`;

    // ãƒ¡ãƒ‹ãƒ¥ãƒ¼æ¤œç´¢ï¼†ãƒªã‚¹ãƒˆ
    html+=`<div class="menu-search">
        <input type="text" placeholder="å•†å“ã‚’æ¤œç´¢..." id="menuSearch" oninput="filterMenu()">
    </div>`;
    const categories = [...new Set(menuData.map(m=>m.category))];
    categories.forEach(cat=>{
        html+=`<div class="menu-category">${cat}</div>`;
        menuData.filter(m=>m.category===cat).forEach(m=>{
            html+=`<div class="menu-item" onclick="addTempOrder(${m.id})">
                <span>${m.name}</span><span>Â¥${m.price}</span>
            </div>`;
        });
    });

    // ä¸€æ™‚æ³¨æ–‡ãƒªã‚¹ãƒˆ
    html+=`<div class="order-section" id="tempOrderSection"><h4>ğŸ“ å…¥åŠ›ä¸­ã®æ³¨æ–‡</h4></div>`;

    // æä¾›æ¸ˆã¿ãƒ»æœªæä¾›æ³¨æ–‡
    const grouped = {pending:orders.filter(o=>o.status==='pending'),delivered:orders.filter(o=>o.status==='delivered')};
    Object.entries({pending:'ğŸ“¥ æ³¨æ–‡å—ä»˜',delivered:'âœ”ï¸ æä¾›æ¸ˆã¿'}).forEach(([status,label])=>{
        if(grouped[status].length>0){
            html+=`<div class="order-section"><h4>${label} (${grouped[status].length}ä»¶)</h4>`;
            grouped[status].forEach(o=>{
                html+=`<div class="order-item ${status==='delivered'?'delivered':''}">
                    <div class="order-item-info">
                        <div class="order-item-name">${o.name}</div>
                        ${o.options?`<div class="order-item-options">${o.options}</div>`:''}
                    </div>
                    <span class="status-label status-${status}">${label.split(' ')[1]}</span>
                    ${status==='pending'?`<button class="btn btn-primary" onclick="updateOrderStatus(${o.id},'delivered')">æä¾›æ¸ˆã¿ã«ã™ã‚‹</button>`:''}
                </div>`;
            });
            html+='</div>';
        }
    });

    // æ³¨æ–‡ç¢ºå®šãƒœã‚¿ãƒ³
    html+=`<div class="action-area">
        <button class="btn btn-success" onclick="confirmOrders()">æ³¨æ–‡ç¢ºå®š</button>
        <button class="btn btn-warning" onclick="clearTempOrders()">ã‚­ãƒ£ãƒ³ã‚»ãƒ«</button>
    </div>`;

    document.getElementById('sidePanel').innerHTML=html;
    renderTempOrders();
}

// ========================
// ä¸€æ™‚æ³¨æ–‡ç®¡ç†
// ========================
function addTempOrder(menuId){
    const menu = menuData.find(m=>m.id===menuId);
    const options = prompt(`${menu.name} ã®ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„ï¼ˆä¾‹:è¾›ã•:ä¸­è¾›ï¼‰`) || null;
    const quantity = parseInt(prompt(`${menu.name} ã®æ•°é‡ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„`,1)) || 1;
    tempOrders.push({...menu, options, quantity});
    renderTempOrders();
}

function renderTempOrders(){
    const container=document.getElementById('tempOrderSection');
    if(!container) return;
    if(tempOrders.length===0){
        container.innerHTML=`<h4>ğŸ“ å…¥åŠ›ä¸­ã®æ³¨æ–‡</h4><p>ã¾ã æ³¨æ–‡ã¯ã‚ã‚Šã¾ã›ã‚“</p>`;
        return;
    }
    let html='<h4>ğŸ“ å…¥åŠ›ä¸­ã®æ³¨æ–‡</h4>';
    tempOrders.forEach((o,i)=>{
        html+=`<div class="order-item">
            <div class="order-item-info">
                <div class="order-item-name">${o.name} Ã—${o.quantity}</div>
                ${o.options?`<div class="order-item-options">${o.options}</div>`:''}
            </div>
            <button class="btn btn-warning" onclick="removeTempOrder(${i})">å‰Šé™¤</button>
        </div>`;
    });
    container.innerHTML=html;
}

function removeTempOrder(index){
    tempOrders.splice(index,1);
    renderTempOrders();
}

function clearTempOrders(){
    if(confirm('å…¥åŠ›ä¸­ã®æ³¨æ–‡ã‚’ã‚­ãƒ£ãƒ³ã‚»ãƒ«ã—ã¾ã™ã‹ï¼Ÿ')){
        tempOrders=[];
        renderTempOrders();
    }
}

// ========================
// æ³¨æ–‡ç¢ºå®š
// ========================
function confirmOrders(){
    if(!currentTableId || tempOrders.length===0) return alert('æ³¨æ–‡ãŒã‚ã‚Šã¾ã›ã‚“');
    if(!ordersData[currentTableId]) ordersData[currentTableId]=[];
    let maxId = Math.max(0,...Object.values(ordersData).flat().map(o=>o.id));
    tempOrders.forEach(o=>{
        ordersData[currentTableId].push({
            id:++maxId,
            name:o.name,
            options:o.options,
            status:'pending',
            price:o.price*o.quantity
        });
    });
    tempOrders=[];
    renderTables();
    selectTable(currentTableId);
    updateNotificationBadge();
}

// ========================
// ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹æ›´æ–°
// ========================
function updateOrderStatus(id,newStatus){
    for(let tId in ordersData){
        const order = ordersData[tId].find(o=>o.id===id);
        if(order){ order.status=newStatus; break; }
    }
    selectTable(currentTableId);
    renderTables();
    updateNotificationBadge();
}

// ========================
// é€šçŸ¥æ›´æ–°
// ========================
function updateNotificationBadge(){
    let pending=0;
    for(let tId in ordersData){
        pending += ordersData[tId].filter(o=>o.status==='pending').length;
    }
    const badge=document.getElementById('notificationBadge');
    badge.textContent=pending;
    if(pending>0) badge.classList.add('active');
    else badge.classList.remove('active');
}

// ========================
// ãƒ¡ãƒ‹ãƒ¥ãƒ¼æ¤œç´¢
// ========================
function filterMenu(){
    const keyword = document.getElementById('menuSearch').value.toLowerCase();
    const categories = [...new Set(menuData.map(m=>m.category))];
    let html='';
    categories.forEach(cat=>{
        const items = menuData.filter(m=>m.category===cat && m.name.toLowerCase().includes(keyword));
        if(items.length>0){
            html+=`<div class="menu-category">${cat}</div>`;
            items.forEach(m=>{
                html+=`<div class="menu-item" onclick="addTempOrder(${m.id})">
                    <span>${m.name}</span><span>Â¥${m.price}</span>
                </div>`;
            });
        }
    });
    document.getElementById('sidePanel').querySelector('.menu-search').insertAdjacentHTML('afterend', html);
}

// ========================
// å±¥æ­´è¡¨ç¤ºï¼ˆå½“æ—¥é™å®šãƒ»ç°¡æ˜“ãƒ¢ãƒ¼ãƒ€ãƒ«ï¼‰
// ========================
function showAllOrdersHistory(){
    let historyHtml='<h3>å½“æ—¥æ³¨æ–‡å±¥æ­´</h3>';
    for(let tId in ordersData){
        const table = tablesData.find(t=>t.id==tId);
        historyHtml+=`<div class="order-section"><h4>ãƒ†ãƒ¼ãƒ–ãƒ« #${table.number}</h4>`;
        ordersData[tId].forEach(o=>{
            historyHtml+=`<div class="order-item ${o.status==='delivered'?'delivered':''}">
                <div class="order-item-info">
                    <div class="order-item-name">${o.name}</div>
                    ${o.options?`<div class="order-item-options">${o.options}</div>`:''}
                </div>
                <span class="status-label status-${o.status}">${o.status==='pending'?'å—ä»˜ä¸­':'æä¾›æ¸ˆã¿'}</span>
            </div>`;
        });
        historyHtml+='</div>';
    }

    const modal = document.createElement('div');
    modal.className='modal active';
    modal.innerHTML=`<div class="modal-content">
        <div class="modal-header">
            <h3>å½“æ—¥æ³¨æ–‡å±¥æ­´</h3>
            <button class="close-btn" onclick="document.body.removeChild(this.parentElement.parentElement)">Ã—</button>
        </div>
        <div class="modal-body">${historyHtml}</div>
        <div class="modal-footer">
            <button class="btn btn-primary" onclick="document.body.removeChild(this.parentElement.parentElement)">é–‰ã˜ã‚‹</button>
        </div>
    </div>`;
    document.body.appendChild(modal);
}
</script>

</body>
</html>